# Copyright (c) Microsoft Corporation.
# Licensed under the MIT License.

name: CodeQL CBL-Mariner repository

parameters:
  - name: marinerBranch
    displayName: "CBL-Mariner branch to 'CodeQL'"
    type: string
    default: '2.0'
    values:
    - '2.0'
    - '3.0'

  - name: analyzeInPipeline
    displayName: "local analysis (for debugging)"
    type: boolean
    default: true

resources:
  repositories:
    - repository: CBL-Mariner-Pipelines
      type: git
      name: mariner/CBL-Mariner-Pipelines
      ref: 'refs/heads/nicolasg/codeQL-toolkit'

stages:
  - stage: CodeQL-Analysis
    template: SDL/pipelines/CodeQL-template.yml@CBL-Mariner-Pipelines
      parameters:
        marinerBranch: ${{ parameters.marinerBranch }}
        analyzeInPipeline: ${{ parameters.analyzeInPipeline }}
