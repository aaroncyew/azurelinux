From 8dfd22f63e00db967ca89cb64446fe6ca8ecabf9 Mon Sep 17 00:00:00 2001
From: Mitch Zhu <mitchzhu@microsoft.com>
Date: Wed, 1 Mar 2023 22:32:56 +0000
Subject: [PATCH] CVE-2023-24329 patch backported from 3.11

---
 Lib/urlparse.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/Lib/urlparse.py b/Lib/urlparse.py
index b800146..cff9f0c 100644
--- a/Lib/urlparse.py
+++ b/Lib/urlparse.py
@@ -211,7 +211,7 @@ def urlsplit(url, scheme='', allow_fragments=True):
         clear_cache()
     netloc = query = fragment = ''
     i = url.find(':')
-    if i > 0:
+    if i > 0 and url[0].isascii() and url[0].isalpha():
         if url[:i] == 'http': # optimize the common case
             scheme = url[:i].lower()
             url = url[i+1:]
-- 
2.33.4

