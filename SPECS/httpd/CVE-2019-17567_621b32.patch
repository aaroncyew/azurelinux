From 621b3206a7db2b4d1c6b974e654cac324a786262 Mon Sep 17 00:00:00 2001
From: Yann Ylavic <ylavic@apache.org>
Date: Fri, 11 Dec 2020 01:19:10 +0000
Subject: [PATCH] Follow up to r1836032: docs for ReadBufferSize,
 FlushMaxThreshold and FlushMaxPipelined.

Plus CHANGES entry.

git-svn-id: https://svn.apache.org/repos/asf/httpd/httpd/trunk@1884296 13f79535-47bb-0310-9956-ffa450edef68
---
 CHANGES                  |  3 +++
 docs/manual/mod/core.xml | 58 ++++++++++++++++++++++++++++++++++++++++
 2 files changed, 61 insertions(+)

diff --git a/CHANGES b/CHANGES
index 3ff8f6d5662..64c9711032c 100644
--- a/CHANGES
+++ b/CHANGES
@@ -1,6 +1,9 @@
                                                          -*- coding: utf-8 -*-
 Changes with Apache 2.4.47
 
+  *) core: add ReadBufferSize, FlushMaxThreshold and FlushMaxPipelined
+     directives.  [Yann Ylavic]
+
   *) mpm_event: don't reset connections after lingering close, restoring prior
      to 2.4.28 behaviour.  [Yann Ylavic]
 
diff --git a/docs/manual/mod/core.xml b/docs/manual/mod/core.xml
index 5bece88aea2..054e6ce2132 100644
--- a/docs/manual/mod/core.xml
+++ b/docs/manual/mod/core.xml
@@ -2012,6 +2012,45 @@ filenames</description>
     different sections are combined when a request is received</seealso>
 </directivesynopsis>
 
+<directivesynopsis>
+<name>FlushMaxPipelined</name>
+<description>Threshold above which pipelined responses are flushed to the
+network</description>
+<syntax>FlushMaxPipelined <var>number</var></syntax>
+<default>FlushMaxPipelined 5</default>
+<contextlist><context>server config</context><context>virtual host</context>
+<context>directory</context></contextlist>
+<compatibility>2.5 and later</compatibility>
+
+<usage>
+    <p>This directive allows to configure the threshold for pipelined
+    responses, which remain pending so long as pipelined request are handled.
+    When this limit is reached, are forcibly flushed to the network in blocking
+    mode, until passing under the threshold again.</p>
+
+    <p>This threshold helps maintaning constrained memory usage.</p>
+</usage>
+</directivesynopsis>
+
+<directivesynopsis>
+<name>FlushMaxThreshold</name>
+<description>Threshold above which pending data are flushed to the
+network</description>
+<syntax>FlushMaxThreshold<var>number-of-bytes</var></syntax>
+<default>FlushMaxThreshold 65536</default>
+<contextlist><context>server config</context><context>virtual host</context>
+<context>directory</context></contextlist>
+<compatibility>2.5 and later</compatibility>
+
+<usage>
+    <p>This directive allows to configure the threshold (in bytes) for pending
+    output data. When this limit is reached, data are forcibly flushed to the
+    network in blocking mode, until passing under the threshold again.</p>
+
+    <p>This threshold helps maintaning constrained memory usage.</p>
+</usage>
+</directivesynopsis>
+
 <directivesynopsis>
 <name>ForceType</name>
 <description>Forces all matching files to be served with the specified
@@ -4054,6 +4093,25 @@ Protocols h2 http/1.1
 </directivesynopsis>
 
 
+<directivesynopsis>
+<name>ReadBufferSize</name>
+<description>Size of the buffers used to read network data</description>
+<syntax>ReadBufferSize <var>number-of-bytes</var></syntax>
+<default>ReadBufferSize 8192</default>
+<contextlist><context>server config</context><context>virtual host</context>
+<context>directory</context></contextlist>
+<compatibility>2.5 and later</compatibility>
+
+<usage>
+    <p>This directive allows to configure the size in bytes of the memory
+    buffers used to read data from the network.</p>
+
+    <p>Larger buffer can increase peformances for large data but consume more
+    memory (per connection).</p>
+</usage>
+</directivesynopsis>
+ 
+
 <directivesynopsis>
     <name>RegexDefaultOptions</name>
     <description>Allow to configure global/default options for regexes</description>
