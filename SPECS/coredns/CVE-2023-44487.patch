From 55978124d8849dbc71f09d5ce8f0e7fb309633f4 Mon Sep 17 00:00:00 2001
From: Daniel McIlvaney <damcilva@microsoft.com>
Date: Mon, 29 Jan 2024 11:42:31 -0800
Subject: [PATCH] Forcibly update golang.org/x/net to v0.17.0 to resolve
 CVE-2023-44487.

v0.10.0,  v0.12.0, v0.14.0 are being used as 2nd/3rd order dependnecies that haven't updated. Force them to use a version of net that isn't vulnerable.

NOTE: Need to run `go mod tidy` after applying this patch to update the go.sum/go.mod files.
---
 go.mod | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/go.mod b/go.mod
index e1e2cc885..b1d2ac838 100644
--- a/go.mod
+++ b/go.mod
@@ -2,6 +2,13 @@ module github.com/coredns/coredns

 go 1.20

+// golang.org/x/net v0.14.0 is vulnerable to CVE-2023-44487 (fixed in 0.17.0).
+// This dependnecy is brought in via:
+//		github.com/openzipkin/zipkin-go v0.4.2 -> github.com/IBM/sarama v1.40.1 -> golang.org/x/net v0.12.0
+// sarama has a newer version available (v1.41.3) which fixes this, but it's not yet used by zipkin-go.
+// x/net should be fairly stable so it is hopefully safe to just upgrade it globally.
+replace golang.org/x/net => golang.org/x/net v0.17.0
+
 require (
 	github.com/Azure/azure-sdk-for-go v68.0.0+incompatible
 	github.com/Azure/go-autorest/autorest v0.11.29
--
2.33.8
