diff --git a/build.xml b/build.xml
index ed104c21..d483a971 100644
--- a/build.xml
+++ b/build.xml
@@ -369,7 +369,7 @@
   <target name="-setup" depends="-dynamic-properties">
     <path id="compile-test.path">
       <path id="test.libs">
-        <fileset dir="lib">
+        <fileset dir="/usr/share/java">
           <include name="junit.jar"/>
           <include name="hamcrest-core-1.3.jar"/>
         </fileset>
@@ -439,7 +439,7 @@
       </srcfiles>
     </uptodate>
   </target>
-  <target name="jar" depends="-setup,native,:jar" unless="-jar"
+  <target name="jar" depends="-setup,compile,:jar" unless="-jar"
           description="Build primary jar">
     <!-- Bundle native components with primary jar to facilitate
          easy distribution to common platforms.
@@ -1265,8 +1089,6 @@ cd ..
     <mkdir dir="${build}/jws"/>
     <copy todir="${build}/jws" file="${build}/${jar}"/>
     <copy todir="${build}/jws" file="${build}/${testjar}"/>
-    <copy todir="${build}/jws" file="lib/junit.jar"/>
-    <copy todir="${build}/jws" file="lib/clover.jar"/>
     <jar jarfile="${build}/jws/jnidispatch.jar" createUnicodeExtraFields="never" encoding="UTF-8">
       <fileset dir="${build.native}" includes="*jnidispatch.*"/>
     </jar>
@@ -1310,7 +1289,6 @@ cd ..
       <doctitle>JNA API Documentation</doctitle>
       <header>${header}</header>
       <bottom>${footer}</bottom>
-      <link href="http://download.oracle.com/javase/${javac.release}/docs/api/"/>
 
       <packageset dir="${src}" defaultexcludes="yes">
         <patternset>
@@ -1485,13 +1306,14 @@ cd ..
       <group title="Platform Specific" packages="com.sun.jna.platform.*"/>
 
       <arg value="-notimestamp"/>
+      <arg value="--allow-script-in-comments"/>
     </javadoc>
     <jar jarfile="${platform-javadoc-jar}" createUnicodeExtraFields="never" encoding="UTF-8">
       <fileset dir="${javadoc}" />
     </jar>
   </target>
 
-  <target name="dist" depends="jar,aar,javadoc,contrib-jars,compile-tests,native"
+  <target name="dist" depends="jar,aar,javadoc,contrib-jars,compile-tests"
           description="Build distribution files">
     <copy todir="${dist}" force="true" overwrite="true">
       <fileset dir="${build}" includes="${jar},${minjar},${aar},${jar-jpms}"/>
diff --git a/native/Makefile b/native/Makefile
index 0c45a85d..a47e8ebd 100644
--- a/native/Makefile
+++ b/native/Makefile
@@ -97,7 +97,7 @@ CDEFINES=-D_REENTRANT
 PCFLAGS=-W -Wall -Wno-unused -Wno-parentheses
 CFLAGS=$(PCFLAGS) $(CFLAGS_EXTRA) $(COPT) $(CDEBUG) $(CDEFINES) $(CINCLUDES) \
        -DJNA_JNI_VERSION='"$(JNA_JNI_VERSION)"' -DCHECKSUM='"$(CHECKSUM)"'
-LDFLAGS=-o $@ -shared
+LDFLAGS=$(RPM_LD_FLAGS) -o $@ -shared
 ifeq ($(DYNAMIC_LIBFFI),true)
 CFLAGS += $(shell pkg-config --cflags libffi 2>/dev/null || echo)
 LIBS += $(shell pkg-config --libs libffi 2>/dev/null || echo -lffi)
@@ -356,11 +356,11 @@ ifeq ($(CC),gcc)
     GCC_MAJOR_VERSION = $(shell gcc -dumpversion | cut -f 1 -d '.')
     ifneq ($(GCC_MAJOR_VERSION),4)
 	ifneq ($(GCC_MAJOR_VERSION),3)
-	    LOC_CC_OPTS=-Wno-unknown-warning-option -Werror -Wno-clobbered -Wno-unused-variable -Wno-alloca-larger-than
+	    LOC_CC_OPTS=-Wno-error -Wno-clobbered -Wno-unused-variable
 	endif
     endif
 else
-    LOC_CC_OPTS=-Wno-unknown-warning-option -Werror -Wno-clobbered -Wno-unused-variable
+    LOC_CC_OPTS=-Wno-error -Wno-clobbered -Wno-unused-variable
 endif
 
 # Enable 64-bit builds if the arch demands it
@@ -486,7 +486,6 @@ $(BUILD)/$(JNA_JNI_VERSION).stamp:
 
 $(LIBRARY): $(JNIDISPATCH_OBJS) $(FFI_LIB)
 	$(LD) $(LDFLAGS) $(JNIDISPATCH_OBJS) $(FFI_LIB) $(LIBS)
-	$(STRIP) $@
 
 $(TESTLIB): $(BUILD)/testlib.o
 	$(LD) $(LDFLAGS) $< $(LIBS)
