From: Alan Modra <amodra@gmail.com>
Date: Thu, 20 Jan 2022 03:28:38 +0000 (+1030)
Subject: PR28753, buffer overflow in read_section_stabs_debugging_info
X-Git-Tag: binutils-2_38~18
X-Git-Url: https://sourceware.org/git/?p=binutils-gdb.git;a=commitdiff_plain;h=cad4d6b91e97b6962807d33c04ed7e7797788438

PR28753, buffer overflow in read_section_stabs_debugging_info

	PR 28753
	* rddbg.c (read_section_stabs_debugging_info): Don't read past
	end of section when concatentating stab strings.

(cherry picked from commit 085b299b71721e15f5c5c5344dc3e4e4536dadba)
---

diff --git a/binutils/rddbg.c b/binutils/rddbg.c
index 42605b83d1a..169c52f4983 100644
--- a/binutils/rddbg.c
+++ b/binutils/rddbg.c
@@ -210,7 +210,7 @@ read_section_stabs_debugging_info (bfd *abfd, asymbol **syms, long symcount,
 		     an attempt to read the byte before 'strings' would occur.  */
 		  while ((len = strlen (s)) > 0
 			 && s[len  - 1] == '\\'
-			 && stab + 12 < stabs + stabsize)
+			 && stab + 16 <= stabs + stabsize)
 		    {
 		      char *p;
 
