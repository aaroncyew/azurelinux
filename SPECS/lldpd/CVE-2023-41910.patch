diff --git a/src/daemon/protocols/cdp.c b/src/daemon/protocols/cdp.c
index 06da59e..87eb40f 100644
--- a/src/daemon/protocols/cdp.c
+++ b/src/daemon/protocols/cdp.c
@@ -485,6 +485,7 @@ cdp_decode(struct lldpd *cfg, char *frame, int s,
                                        goto malformed;
                                }
                                PEEK_DISCARD(address_len);
+                               addresses_len -= address_len;
                                (void)PEEK_SAVE(pos_next_address);
                                /* Next, we go back and try to extract
                                   IPv4 address */