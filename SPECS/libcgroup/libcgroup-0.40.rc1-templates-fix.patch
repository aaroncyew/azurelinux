diff --git a/src/api.c b/src/api.c
index 1e4f021..33e99b6 100644
--- a/src/api.c
+++ b/src/api.c
@@ -4177,9 +4177,9 @@ int cgroup_change_cgroup_flags(uid_t uid, gid_t gid, const char *procname, pid_t
 					written = snprintf(newdest + j,	available, "%d", pid);
 					break;
 				case 'p':
-					if (procname) {
+					if(procname && strlen(basename(procname))) {
 						written = snprintf(newdest + j,	available, "%s",
-								   procname);
+								   basename(procname));
 					} else {
 						written = snprintf(newdest + j,	available, "%d",
 								   pid);
								